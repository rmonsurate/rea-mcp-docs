%%{init: {'theme': 'base', 'themeVariables': { 'primaryColor': '#a484fb', 'primaryTextColor': '#ffffff', 'primaryBorderColor': '#a484fb', 'secondaryColor': '#22c55a', 'secondaryTextColor': '#ffffff', 'tertiaryColor': '#1e293b', 'lineColor': '#a484fb', 'textColor': '#f8fafc', 'mainBkg': '#0f172a', 'nodeBorder': '#a484fb', 'clusterBkg': '#020817', 'clusterBorder': '#a484fb', 'nodeTextColor': '#ffffff', 'edgeLabelBackground': '#0f172a'}}}%%
flowchart LR
    subgraph Rea["Rea Platform"]
        User["User Request"]
        Agent["AI Agent"]
        Client["PHP MCP Client"]
    end

    subgraph MCP["Notion MCP Server"]
        Parser["OpenAPI Parser"]
        Proxy["MCP Proxy"]
        HTTP["HTTP Client"]
    end

    subgraph Notion["Notion"]
        API["Notion API v1"]
        Pages[("Pages")]
        DBs[("Databases")]
        Blocks[("Blocks")]
    end

    User -->|"Search meeting notes"| Agent
    Agent -->|tools/call| Client
    Client -->|JSON-RPC| Proxy
    Proxy --> Parser
    Parser -->|Generate Tool| Proxy
    Proxy --> HTTP
    HTTP -->|POST /v1/search| API
    API --> Pages
    API --> DBs
    API --> Blocks
    API -->|Results| HTTP
    HTTP --> Proxy
    Proxy -->|Tool Result| Client
    Client --> Agent
    Agent -->|"Found 5 pages..."| User
